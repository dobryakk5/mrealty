# Извлечение фотографий в высоком качестве с навигацией по слайдеру

## Обзор

Новая функциональность позволяет извлекать все фотографии объявления Avito в высоком качестве через навигацию по слайдеру изображений.

## Проблема

Ранее парсер получал:
- Одно изображение в хорошем качестве (главное фото)
- Остальные изображения только в preview-качестве (1x, 1.5x)

## Решение

Реализована комбинированная стратегия извлечения:

### 1. Клики по Preview-изображениям
- Находятся все preview-изображения в галерее
- По каждому выполняется клик для загрузки в главном слайдере
- Извлекается полноразмерная версия

### 2. Навигация стрелками
- Используются кнопки "вперед" для перехода к следующим изображениям
- Извлекаются изображения, которые могли быть пропущены
- Максимум 20 попыток навигации

### 3. Приоритет качества
- **3x** - максимальное качество (приоритет 1)
- **2x** - высокое качество (приоритет 2)  
- **1.5x** - среднее качество (приоритет 3)
- **1x** - низкое качество (исключается)

## Новые методы

### `extract_high_quality_photos()`
Основной метод извлечения через клики по preview

### `extract_current_main_photo()`
Извлекает текущее изображение из главного слайдера

### `navigate_with_arrows()`
Навигация стрелками для дополнительных изображений

### `extract_photos_with_slider_navigation()`
Комбинированный метод с полной навигацией

### `wait_for_image_loading()`
Ожидание загрузки изображений

### `check_image_quality()`
Проверка качества изображения по URL

### `log_photo_extraction_summary()`
Детальное логирование процесса извлечения

## Использование

### Автоматическое использование
```python
from avito_parser_integration import AvitoCardParser

parser = AvitoCardParser()
result = parser.parse_avito_page(url)
# Автоматически использует новый метод извлечения
```

### Ручное использование
```python
# Только preview-клики
photos = parser.extract_high_quality_photos()

# Только навигация стрелками  
photos = parser.navigate_with_arrows([])

# Комбинированный метод
photos = parser.extract_photos_with_slider_navigation()
```

## Тестирование

Запустите тестовый скрипт:
```bash
python test_photo_extraction.py
```

Введите URL объявления Avito для проверки функциональности.

## Логирование

Подробное логирование процесса:
- Количество найденных preview-изображений
- Процесс обработки каждого изображения
- Статистика по качеству
- Сводка по всем извлеченным фотографиям

## Ограничения

- Максимум 50 фотографий для предотвращения зацикливания
- Таймаут 10 секунд на загрузку изображений
- Задержка 2 секунды между кликами для стабильности

## Совместимость

- Автоматически откатывается к базовому методу при ошибках
- Сохраняет обратную совместимость
- Не влияет на существующий функционал

## Преимущества

1. **Качество**: Все изображения в максимальном доступном качестве
2. **Полнота**: Извлекаются все доступные фотографии
3. **Надежность**: Автоматический fallback при ошибках
4. **Мониторинг**: Детальное логирование процесса
5. **Гибкость**: Возможность выбора стратегии извлечения
