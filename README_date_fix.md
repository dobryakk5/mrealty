# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ —Å –¥–∞—Ç–∞–º–∏ –≤ –ø–∞—Ä—Å–µ—Ä–µ Avito

## üö® –ü—Ä–æ–±–ª–µ–º–∞
**–û—à–∏–±–∫–∞**: `unsupported operand type(s) for -: 'datetime.datetime' and 'datetime.date'`

**–ü—Ä–∏—á–∏–Ω–∞**: –§—É–Ω–∫—Ü–∏–∏ –ø–∞—Ä—Å–∏–Ω–≥–∞ –¥–∞—Ç –≤–æ–∑–≤—Ä–∞—â–∞–ª–∏ —Ä–∞–∑–Ω—ã–µ —Ç–∏–ø—ã:
- `convert_relative_time_to_date` - –∏–Ω–æ–≥–¥–∞ `datetime.datetime`, –∏–Ω–æ–≥–¥–∞ `datetime.date`
- `parse_card_date` - –∏–Ω–æ–≥–¥–∞ `datetime.datetime`, –∏–Ω–æ–≥–¥–∞ `datetime.date`
- `get_oldest_card_date` - —Å–º–µ—à–∏–≤–∞–ª–∞ —Ç–∏–ø—ã –ø—Ä–∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–∏

## ‚úÖ –†–µ—à–µ–Ω–∏–µ
**–£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞—Ç** - –≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ç–µ–ø–µ—Ä—å –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç `datetime.datetime` –¥–ª—è –µ–¥–∏–Ω–æ–æ–±—Ä–∞–∑–∏—è.

## üîß –ß—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

### 1. –§—É–Ω–∫—Ü–∏—è `convert_relative_time_to_date`
```python
# –ë–´–õ–û: –†–∞–∑–Ω—ã–µ —Ç–∏–ø—ã –≤–æ–∑–≤—Ä–∞—Ç–∞
if unit == 'hours':
    return target_time  # datetime.datetime
elif unit == 'days':
    return target_time.date()  # datetime.date

# –°–¢–ê–õ–û: –í—Å–µ–≥–¥–∞ datetime.datetime
if unit == 'hours':
    return target_time  # datetime.datetime
elif unit == 'days':
    # –î–ª—è –¥–Ω–µ–π/–Ω–µ–¥–µ–ª—å/–º–µ—Å—è—Ü–µ–≤ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø–æ–ª–¥–µ–Ω—å (12:00)
    target_date = target_time.date()
    return datetime.combine(target_date, datetime.min.time().replace(hour=12))
```

### 2. –§—É–Ω–∫—Ü–∏—è `parse_card_date`
```python
# –ë–´–õ–û: –ò–Ω–æ–≥–¥–∞ datetime.date
result = datetime(year, month_num, day).date()

# –°–¢–ê–õ–û: –í—Å–µ–≥–¥–∞ datetime.datetime
# –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –≤—Ä–µ–º—è –≤ —Å—Ç—Ä–æ–∫–µ
time_match = re.search(r'(\d{1,2}):(\d{1,2})', date_text.lower())
if time_match:
    # –ï—Å—Ç—å –≤—Ä–µ–º—è - –∏—Å–ø–æ–ª—å–∑—É–µ–º –µ–≥–æ
    hour = int(time_match.group(1))
    minute = int(time_match.group(2))
else:
    # –í—Ä–µ–º—è –Ω–µ —É–∫–∞–∑–∞–Ω–æ - —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø–æ–ª–¥–µ–Ω—å (12:00)
    hour = 12
    minute = 0

card_datetime = datetime(current_year, month_num, day, hour, minute)
```

### 3. –§—É–Ω–∫—Ü–∏—è `get_oldest_card_date`
```python
# –ë–´–õ–û: –°–º–µ—à–∏–≤–∞–Ω–∏–µ —Ç–∏–ø–æ–≤
if hasattr(card_date, 'date'):
    # –ï—Å–ª–∏ —ç—Ç–æ datetime, –±–µ—Ä–µ–º —Ç–æ–ª—å–∫–æ –¥–∞—Ç—É
    card_date = card_date.date()

# –°–¢–ê–õ–û: –ï–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
# –¢–µ–ø–µ—Ä—å card_date –≤—Å–µ–≥–¥–∞ datetime.datetime
if oldest_date is None or card_date < oldest_date:
    oldest_date = card_date
```

## üìä –õ–æ–≥–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤—Ä–µ–º–µ–Ω–∏

### –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ–µ –≤—Ä–µ–º—è
- **"—Å–µ–≥–æ–¥–Ω—è"** ‚Üí `datetime.now()` (—Ç–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è)
- **"–≤—á–µ—Ä–∞"** ‚Üí `datetime.now() - 1 –¥–µ–Ω—å` (—Ç–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è)
- **"2 –¥–Ω—è –Ω–∞–∑–∞–¥"** ‚Üí `datetime.now() - 2 –¥–Ω—è` –≤ 12:00
- **"3 —á–∞—Å–∞ –Ω–∞–∑–∞–¥"** ‚Üí `datetime.now() - 3 —á–∞—Å–∞` (—Ç–æ—á–Ω–æ–µ –≤—Ä–µ–º—è)

### –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –¥–∞—Ç—ã
- **"12 –∏—é–ª—è"** ‚Üí `12 –∏—é–ª—è 12:00` (–ø–æ–ª–¥–µ–Ω—å)
- **"12 –∏—é–ª—è 15:30"** ‚Üí `12 –∏—é–ª—è 15:30` (—É–∫–∞–∑–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è)
- **"25.12"** ‚Üí `25 –¥–µ–∫–∞–±—Ä—è 12:00` (–ø–æ–ª–¥–µ–Ω—å)
- **"25.12.2024"** ‚Üí `25 –¥–µ–∫–∞–±—Ä—è 2024 12:00` (–ø–æ–ª–¥–µ–Ω—å)

### –ù–µ–ø–æ–Ω—è—Ç–Ω—ã–µ –¥–∞—Ç—ã
- **"–Ω–µ–ø–æ–Ω—è—Ç–Ω–∞—è –¥–∞—Ç–∞"** ‚Üí `None` (–Ω–µ –ø–∞—Ä—Å–∏—Ç—Å—è)

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ
- ‚úÖ –í—Å–µ —Ñ–æ—Ä–º–∞—Ç—ã –¥–∞—Ç –ø–∞—Ä—Å—è—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç `datetime.datetime`
- ‚úÖ –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –¥–∞—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –æ—à–∏–±–æ–∫
- ‚úÖ –í—ã—á–∏—Å–ª–µ–Ω–∏–µ —Ä–∞–∑–Ω–æ—Å—Ç–∏ –¥–Ω–µ–π –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø–æ –¥–∞—Ç–µ (`max_days`) —Ä–∞–±–æ—Ç–∞–µ—Ç

### –¢–µ—Å—Ç–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏
```python
# –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ–µ –≤—Ä–µ–º—è
"—Å–µ–≥–æ–¥–Ω—è" ‚Üí 2025-08-26 22:33:22 (datetime)
"–≤—á–µ—Ä–∞" ‚Üí 2025-08-25 22:33:22 (datetime)
"2 –¥–Ω—è –Ω–∞–∑–∞–¥" ‚Üí 2025-08-24 12:00:00 (datetime)

# –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –¥–∞—Ç—ã
"12 –∏—é–ª—è" ‚Üí 2025-07-12 12:00:00 (datetime)
"12 –∏—é–ª—è 15:30" ‚Üí 2025-07-12 15:30:00 (datetime)
"25.12" ‚Üí 2024-12-25 12:00:00 (datetime)

# –í—ã—á–∏—Å–ª–µ–Ω–∏–µ —Ä–∞–∑–Ω–æ—Å—Ç–∏
(datetime.now() - oldest_date).days ‚Üí –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç
```

## üìà –†–µ–∑—É–ª—å—Ç–∞—Ç

### –î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- ‚ùå –û—à–∏–±–∫–∞ `unsupported operand type(s) for -: 'datetime.datetime' and 'datetime.date'`
- ‚ùå –°–º–µ—à–∏–≤–∞–Ω–∏–µ —Ç–∏–ø–æ–≤ –¥–∞—Ç
- ‚ùå –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø–æ –¥–∞—Ç–µ
- ‚ùå –ü–∞—Ä—Å–∏–Ω–≥ –ø—Ä–µ—Ä—ã–≤–∞–ª—Å—è —Å –æ—à–∏–±–∫–æ–π

### –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- ‚úÖ –í—Å–µ –¥–∞—Ç—ã –ø—Ä–∏–≤–æ–¥—è—Ç—Å—è –∫ `datetime.datetime`
- ‚úÖ –ï–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Ä–µ–º–µ–Ω–∏
- ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø–æ –¥–∞—Ç–µ
- ‚úÖ –°—Ç–∞–±–∏–ª—å–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥ –±–µ–∑ –æ—à–∏–±–æ–∫

## üîç –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã
1. **–í—Å–µ –¥–∞—Ç—ã –ø–∞—Ä—Å—è—Ç—Å—è –≤ `datetime.datetime`**
2. **–ï—Å–ª–∏ –≤—Ä–µ–º—è –Ω–µ —É–∫–∞–∑–∞–Ω–æ, —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –ø–æ–ª–¥–µ–Ω—å (12:00)**
3. **–û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ–µ –≤—Ä–µ–º—è —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ç–æ—á–Ω–æ—Å—Ç—å (—á–∞—Å—ã)**
4. **–ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –¥–∞—Ç—ã –ø–æ–ª—É—á–∞—é—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –≤—Ä–µ–º—è (12:00)**

### –û–±—Ä–∞–±–æ—Ç–∫–∞ edge cases
- **–ù–µ–ø–æ–Ω—è—Ç–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã** ‚Üí `None` (–±–µ–∑ –æ—à–∏–±–æ–∫)
- **–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –¥–∞—Ç—ã** ‚Üí `None` (–±–µ–∑ –æ—à–∏–±–æ–∫)
- **–ë—É–¥—É—â–∏–µ –¥–∞—Ç—ã** ‚Üí –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–µ—Ç—Å—è –≥–æ–¥
- **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤—Ä–µ–º–µ–Ω–∏** ‚Üí —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –ø–æ–ª–¥–µ–Ω—å

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –î–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø–æ –¥–∞—Ç–µ**: –¢–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ
- **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**: –°–ª–µ–¥–∏—Ç–µ –∑–∞ –ª–æ–≥–∞–º–∏ –ø–∞—Ä—Å–∏–Ω–≥–∞ –¥–∞—Ç
- **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã –¥–∞—Ç

### –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- **–í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `datetime.datetime`** –¥–ª—è –¥–∞—Ç
- **–£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–π—Ç–µ –ø–æ–ª–¥–µ–Ω—å (12:00)** –¥–ª—è –¥–∞—Ç –±–µ–∑ –≤—Ä–µ–º–µ–Ω–∏
- **–û–±—Ä–∞–±–∞—Ç—ã–≤–∞–π—Ç–µ `None`** –ø—Ä–∏ –ø–∞—Ä—Å–∏–Ω–≥–µ –¥–∞—Ç
- **–¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ edge cases** —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ —Ñ–æ—Ä–º–∞—Ç–∞–º–∏

---

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ  
**–û—à–∏–±–∫–∞:** ‚úÖ –£—Å—Ç—Ä–∞–Ω–µ–Ω–∞  
**–¢–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö:** ‚úÖ –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω—ã  
**–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å:** ‚úÖ –£–ª—É—á—à–µ–Ω–∞
