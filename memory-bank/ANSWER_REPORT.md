# –û—Ç–≤–µ—Ç –Ω–∞ –≤–æ–ø—Ä–æ—Å: "–ø—Ä–æ–≤–µ—Ä—å –∑–∞–ø—É—Å–∫ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º 1d, –±—É–¥–µ—Ç –ª–∏ –≤ —Å—Ç—Ä–æ–∫–µ –ø–æ–∏—Å–∫–∞ -2"

## ‚úÖ **–î–ê, –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º `1d` –≤ —Å—Ç—Ä–æ–∫–µ –ø–æ–∏—Å–∫–∞ –ë–£–î–ï–¢ –∑–Ω–∞—á–µ–Ω–∏–µ `-2`**

### üîç **–î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑:**

#### 1. **–ü–∞—Ä—Å–∏–Ω–≥ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ `1d`:**
```python
# –í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ: "1d"
property_type, time_period = parse_params_string("1d")
# –†–µ–∑—É–ª—å—Ç–∞—Ç:
#   property_type = 1 (–≤—Ç–æ—Ä–∏—á–∫–∞)
#   time_period = "d" (–¥–µ–Ω—å)
```

#### 2. **–ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –ø–µ—Ä–∏–æ–¥–∞ –≤—Ä–µ–º–µ–Ω–∏:**
```python
time_period_seconds = convert_time_period("d")
# –†–µ–∑—É–ª—å—Ç–∞—Ç: -2
```

**–í–∞–∂–Ω–æ:** –ó–Ω–∞—á–µ–Ω–∏–µ `-2` - —ç—Ç–æ **—Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä CIAN API** –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞ "–∑–∞ –¥–µ–Ω—å", –∞ –Ω–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–µ–∫—É–Ω–¥.

#### 3. **–§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ URL:**
```python
url = build_search_url(property_type=1, time_period=-2)
# –†–µ–∑—É–ª—å—Ç–∞—Ç:
# https://www.cian.ru/cat.php?deal_type=sale&engine_version=2&offer_type=flat&region=1&only_foot=2&object_type%5B0%5D=1&totime=-2
```

### üìã **–ü–æ–ª–Ω—ã–π URL –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ `python parse_cian_to_db.py 1d`:**

```
https://www.cian.ru/cat.php?deal_type=sale&engine_version=2&offer_type=flat&region=1&only_foot=2&object_type%5B0%5D=1&totime=-2
```

**–ö–ª—é—á–µ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `object_type%5B0%5D=1` ‚Üê —Ç–∏–ø –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏: –≤—Ç–æ—Ä–∏—á–∫–∞
- `totime=-2` ‚Üê —Ñ–∏–ª—å—Ç—Ä –ø–æ –≤—Ä–µ–º–µ–Ω–∏: –∑–∞ –¥–µ–Ω—å

### üîÑ **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ —Ç–∞–±–ª–∏—Ü—É –ø—Ä–æ–≥—Ä–µ—Å—Å–∞:**

–ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º `1d` –≤ —Ç–∞–±–ª–∏—Ü—É `system.parsing_progress` –±—É–¥–µ—Ç –∑–∞–ø–∏—Å–∞–Ω–æ:
```sql
INSERT INTO system.parsing_progress (
    property_type,    -- 1 (–≤—Ç–æ—Ä–∏—á–∫–∞)
    time_period,      -- -2 (–∑–∞ –¥–µ–Ω—å)
    current_metro_id, -- ID –ø–µ—Ä–≤–æ–π —Å—Ç–∞–Ω—Ü–∏–∏ –º–µ—Ç—Ä–æ
    status,           -- 'active'
    total_metros      -- –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç–∞–Ω—Ü–∏–π
) VALUES (1, -2, ...);
```

### üß™ **–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:**

–í—Å–µ —Ç–µ—Å—Ç—ã –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å —Ä–∞–±–æ—Ç—ã:

1. **–¢–µ—Å—Ç —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è URL** ‚úÖ
   - –ü–∞—Ä–∞–º–µ—Ç—Ä `1d` ‚Üí `totime=-2` –≤ URL

2. **–¢–µ—Å—Ç –ø–æ–ª–Ω–æ–≥–æ —Ü–∏–∫–ª–∞** ‚úÖ
   - –ü–∞—Ä—Å–∏–Ω–≥ ‚Üí –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è ‚Üí –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ URL ‚Üí –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ø—Ä–æ–≥—Ä–µ—Å—Å

3. **–¢–µ—Å—Ç —Å–∏—Å—Ç–µ–º—ã –ø—Ä–æ–≥—Ä–µ—Å—Å–∞** ‚úÖ
   - –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –∏ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è

### üìö **–û–±—ä—è—Å–Ω–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è `-2`:**

–í CIAN API –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–æ–≤ –≤—Ä–µ–º–µ–Ω–∏:
- `-2` = "–∑–∞ –¥–µ–Ω—å" (—Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ, –Ω–µ —Å–µ–∫—É–Ω–¥—ã)
- `3600` = "–∑–∞ —á–∞—Å" (3600 —Å–µ–∫—É–Ω–¥)
- `604800` = "–∑–∞ –Ω–µ–¥–µ–ª—é" (604800 —Å–µ–∫—É–Ω–¥)

### üéØ **–ó–∞–∫–ª—é—á–µ–Ω–∏–µ:**

**–î–ê, –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ `python parse_cian_to_db.py 1d`:**
1. ‚úÖ –í URL –ø–æ–∏—Å–∫–∞ –±—É–¥–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä `&totime=-2`
2. ‚úÖ –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç —Ñ–∏–ª—å—Ç—Ä "–∑–∞ –¥–µ–Ω—å" –¥–ª—è –≤—Ç–æ—Ä–∏—á–∫–∏
3. ‚úÖ –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Å–æ—Ö—Ä–∞–Ω—è—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü—É –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
4. ‚úÖ –ü—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º –∑–∞–ø—É—Å–∫–µ —Ä–∞–±–æ—Ç–∞ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—Å—è —Å –º–µ—Å—Ç–∞ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏

–ü–∞—Ä—Å–µ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã CIAN API.
