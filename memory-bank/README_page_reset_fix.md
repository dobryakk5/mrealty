# üîß –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ª–æ–≥–∏–∫–∏ —Å–±—Ä–æ—Å–∞ —Å—Ç—Ä–∞–Ω–∏—Ü –ø—Ä–∏ –Ω–æ–≤–æ–º —Ü–∏–∫–ª–µ

## ‚ùå **–ü—Ä–æ–±–ª–µ–º–∞**

–ï—Å–ª–∏ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –Ω–æ–≤—ã–π —Ü–∏–∫–ª —Ä–∞–±–æ—Ç—ã —Å –ø–µ—Ä–≤–æ–≥–æ –º–µ—Ç—Ä–æ, —Ç–æ –Ω—É–∂–Ω–æ –¥–µ–ª–∞—Ç—å —Å–±—Ä–æ—Å —Å—Ç—Ä–∞–Ω–∏—Ü –≤ —Ç–∞–±–ª–∏—Ü–µ `system.avito_pagination_tracking`, —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—è `last_processed_page=0`.

**–¶–µ–ª—å**: –û–±–µ—Å–ø–µ—á–∏—Ç—å, —á—Ç–æ–±—ã –ø—Ä–∏ –Ω–æ–≤–æ–º —Ü–∏–∫–ª–µ –ø–∞—Ä—Å–∏–Ω–≥ –Ω–∞—á–∏–Ω–∞–ª—Å—è —Å –ø–µ—Ä–≤–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∫–∞–∂–¥–æ–≥–æ –º–µ—Ç—Ä–æ, –∞ –Ω–µ –ø—Ä–æ–¥–æ–ª–∂–∞–ª —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã.

## ‚úÖ **–†–µ—à–µ–Ω–∏–µ**

–î–æ–±–∞–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Å–±—Ä–æ—Å–∞ —Å—Ç—Ä–∞–Ω–∏—Ü –≤ —Å–ª–µ–¥—É—é—â–∏—Ö —Å–ª—É—á–∞—è—Ö:

### 1. **–ù–æ–≤–∞—è —Å–µ—Å—Å–∏—è –±–∞—Ç—á–µ–π**
```python
else:
    print(f"üÜï –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—É—é —Å–µ—Å—Å–∏—é –ø–∞—Ä—Å–∏–Ω–≥–∞ –±–∞—Ç—á–µ–π")
    # üîß –°–ë–†–û–° –°–¢–†–ê–ù–ò–¶: –ï—Å–ª–∏ —Å–æ–∑–¥–∞–µ–º –Ω–æ–≤—É—é —Å–µ—Å—Å–∏—é, —Å–±—Ä–∞—Å—ã–≤–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—ã
    print(f"üîÑ –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—ã –¥–ª—è –≤—Å–µ—Ö –º–µ—Ç—Ä–æ (–Ω–æ–≤—ã–π —Ü–∏–∫–ª)")
    await reset_avito_pagination()  # –°–±—Ä–æ—Å –¥–ª—è –≤—Å–µ—Ö –º–µ—Ç—Ä–æ
```

### 2. **–ù–∞—á–∏–Ω–∞–µ–º —Å –ø–µ—Ä–≤–æ–π –ø–∞—á–∫–∏**
```python
else:
    print(f"üÜï –ù–∞—á–∏–Ω–∞–µ–º —Å –ø–µ—Ä–≤–æ–π –ø–∞—á–∫–∏ (–Ω–µ –Ω–∞–π–¥–µ–Ω–æ –º–µ—Å—Ç–æ –≤–æ–∑–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è)")
    # üîß –°–ë–†–û–° –°–¢–†–ê–ù–ò–¶: –ï—Å–ª–∏ –Ω–∞—á–∏–Ω–∞–µ–º —Å –ø–µ—Ä–≤–æ–π –ø–∞—á–∫–∏, —Å–±—Ä–∞—Å—ã–≤–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—ã
    print(f"üîÑ –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—ã –¥–ª—è –≤—Å–µ—Ö –º–µ—Ç—Ä–æ (–Ω–æ–≤—ã–π —Ü–∏–∫–ª)")
    await reset_avito_pagination()  # –°–±—Ä–æ—Å –¥–ª—è –≤—Å–µ—Ö –º–µ—Ç—Ä–æ
```

### 3. **–û–±—ã—á–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥ –±–µ–∑ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞**
```python
else:
    # –û–±—ã—á–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥ –ø–æ –æ–¥–Ω–æ–º—É –º–µ—Ç—Ä–æ
    # üîß –°–ë–†–û–° –°–¢–†–ê–ù–ò–¶: –î–ª—è –æ–±—ã—á–Ω–æ–≥–æ –ø–∞—Ä—Å–∏–Ω–≥–∞ –≤—Å–µ–≥–¥–∞ —Å–±—Ä–∞—Å—ã–≤–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—ã
    if not use_progress_tracking:
        print(f"üîÑ –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—ã –¥–ª—è –≤—Å–µ—Ö –º–µ—Ç—Ä–æ (–æ–±—ã—á–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥)")
        await reset_avito_pagination()  # –°–±—Ä–æ—Å –¥–ª—è –≤—Å–µ—Ö –º–µ—Ç—Ä–æ
```

## üìç **–ú–µ—Å—Ç–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è**

**–§–∞–π–ª**: `parse_avito_to_db.py`  
**–°—Ç—Ä–æ–∫–∏**: 1010-1020, 1040-1050  
**–§—É–Ω–∫—Ü–∏—è**: `main()`  
**–ö–æ–Ω—Ç–µ–∫—Å—Ç**: –õ–æ–≥–∏–∫–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ä–µ–∂–∏–º–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞

## üß™ **–õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã**

### –°—Ü–µ–Ω–∞—Ä–∏–∏, –∫–æ–≥–¥–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Å–±—Ä–æ—Å —Å—Ç—Ä–∞–Ω–∏—Ü:

#### ‚úÖ **–°–ë–†–û–° –°–¢–†–ê–ù–ò–¶ –û–ë–Ø–ó–ê–¢–ï–õ–ï–ù:**

1. **–ù–æ–≤–∞—è —Å–µ—Å—Å–∏—è –±–∞—Ç—á–µ–π**
   - –£—Å–ª–æ–≤–∏–µ: `use_progress_tracking = True`, `progress = None`
   - –î–µ–π—Å—Ç–≤–∏–µ: –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—É—é —Å–µ—Å—Å–∏—é
   - –ü—Ä–∏—á–∏–Ω–∞: –ù–∞—á–∏–Ω–∞–µ—Ç—Å—è –Ω–æ–≤—ã–π —Ü–∏–∫–ª —Ä–∞–±–æ—Ç—ã

2. **–ù–∞—á–∏–Ω–∞–µ–º —Å –ø–µ—Ä–≤–æ–π –ø–∞—á–∫–∏**
   - –£—Å–ª–æ–≤–∏–µ: `use_progress_tracking = True`, `current_batch_index = -1`
   - –î–µ–π—Å—Ç–≤–∏–µ: –ù–∞—á–∏–Ω–∞–µ–º —Å –ø–µ—Ä–≤–æ–π –ø–∞—á–∫–∏
   - –ü—Ä–∏—á–∏–Ω–∞: –ù–µ –Ω–∞–π–¥–µ–Ω–æ –º–µ—Å—Ç–æ –≤–æ–∑–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è, –Ω–∞—á–∏–Ω–∞–µ–º –∑–∞–Ω–æ–≤–æ

3. **–û–±—ã—á–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥ –±–µ–∑ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞**
   - –£—Å–ª–æ–≤–∏–µ: `use_progress_tracking = False`
   - –î–µ–π—Å—Ç–≤–∏–µ: –û–±—ã—á–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥ –ø–æ –æ–¥–Ω–æ–º—É –º–µ—Ç—Ä–æ
   - –ü—Ä–∏—á–∏–Ω–∞: –ù–µ—Ç –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞, –Ω–∞—á–∏–Ω–∞–µ–º —Å –Ω–∞—á–∞–ª–∞

#### ‚ùå **–°–ë–†–û–° –°–¢–†–ê–ù–ò–¶ –ù–ï –ù–£–ñ–ï–ù:**

4. **–ü—Ä–æ–¥–æ–ª–∂–∞–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é —Å–µ—Å—Å–∏—é**
   - –£—Å–ª–æ–≤–∏–µ: `use_progress_tracking = True`, `current_batch_index >= 0`
   - –î–µ–π—Å—Ç–≤–∏–µ: –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º —Å –Ω–∞–π–¥–µ–Ω–Ω–æ–π –ø–∞—á–∫–∏
   - –ü—Ä–∏—á–∏–Ω–∞: –í–æ–∑–æ–±–Ω–æ–≤–ª—è–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é —Å–µ—Å—Å–∏—é

## üîç **SQL-–∑–∞–ø—Ä–æ—Å –¥–ª—è —Å–±—Ä–æ—Å–∞**

–§—É–Ω–∫—Ü–∏—è `reset_avito_pagination()` –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Å–ª–µ–¥—É—é—â–∏–π SQL-–∑–∞–ø—Ä–æ—Å:

```sql
-- –°–±—Ä–æ—Å –¥–ª—è –≤—Å–µ—Ö –º–µ—Ç—Ä–æ
UPDATE system.avito_pagination_tracking
SET last_processed_page = 0, 
    total_pages_processed = 0, 
    last_updated = CURRENT_TIMESTAMP

-- –°–±—Ä–æ—Å –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –º–µ—Ç—Ä–æ (–µ—Å–ª–∏ –ø–µ—Ä–µ–¥–∞—Ç—å metro_id)
UPDATE system.avito_pagination_tracking
SET last_processed_page = 0, 
    total_pages_processed = 0, 
    last_updated = CURRENT_TIMESTAMP
WHERE metro_id = $1
```

## üéØ **–†–µ–∑—É–ª—å—Ç–∞—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∏—è**

### –î–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è:
```
–ù–æ–≤—ã–π –∑–∞–ø—É—Å–∫: python parse_avito_to_db.py --all --batch-size 5
‚ùå –°—Ç—Ä–∞–Ω–∏—Ü—ã –ù–ï —Å–±—Ä–∞—Å—ã–≤–∞–ª–∏—Å—å
‚ùå –ü–∞—Ä—Å–∏–Ω–≥ –ø—Ä–æ–¥–æ–ª–∂–∞–ª —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã
‚ùå –í–æ–∑–º–æ–∂–Ω—ã –ø—Ä–æ–ø—É—Å–∫–∏ –Ω–æ–≤—ã—Ö –æ–±—ä—è–≤–ª–µ–Ω–∏–π
```

### –ü–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è:
```
–ù–æ–≤—ã–π –∑–∞–ø—É—Å–∫: python parse_avito_to_db.py --all --batch-size 5
‚úÖ –°—Ç—Ä–∞–Ω–∏—Ü—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–±—Ä–∞—Å—ã–≤–∞—é—Ç—Å—è
‚úÖ –ü–∞—Ä—Å–∏–Ω–≥ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å –ø–µ—Ä–≤–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∫–∞–∂–¥–æ–≥–æ –º–µ—Ç—Ä–æ
‚úÖ –í—Å–µ –Ω–æ–≤—ã–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è –±—É–¥—É—Ç –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã
```

## üöÄ **–ü—Ä–∏–º–µ—Ä—ã —Ä–∞–±–æ—Ç—ã**

### –ü—Ä–∏–º–µ—Ä 1: –ù–æ–≤—ã–π –∑–∞–ø—É—Å–∫
```bash
# –ö–æ–º–∞–Ω–¥–∞
python parse_avito_to_db.py --all --batch-size 5

# –†–µ–∑—É–ª—å—Ç–∞—Ç
üÜï –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—É—é —Å–µ—Å—Å–∏—é –ø–∞—Ä—Å–∏–Ω–≥–∞ –±–∞—Ç—á–µ–π
üîÑ –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—ã –¥–ª—è –≤—Å–µ—Ö –º–µ—Ç—Ä–æ (–Ω–æ–≤—ã–π —Ü–∏–∫–ª)
‚úÖ –°–±—Ä–æ—à–µ–Ω —Å—Ç–∞—Ç—É—Å –ø–∞–≥–∏–Ω–∞—Ü–∏–∏ –¥–ª—è –≤—Å–µ—Ö –º–µ—Ç—Ä–æ
```

### –ü—Ä–∏–º–µ—Ä 2: –í–æ–∑–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
```bash
# –ö–æ–º–∞–Ω–¥–∞ (–ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –∞–∫—Ç–∏–≤–Ω–æ–π —Å–µ—Å—Å–∏–∏)
python parse_avito_to_db.py --all --batch-size 5

# –†–µ–∑—É–ª—å—Ç–∞—Ç
üîç –ù–∞–π–¥–µ–Ω–∞ –∞–∫—Ç–∏–≤–Ω–∞—è —Å–µ—Å—Å–∏—è –±–∞—Ç—á–µ–π: ID=123
üîÑ –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º —Å –ø–∞—á–∫–∏ 5/20
# –°–ë–†–û–° –°–¢–†–ê–ù–ò–¶ –ù–ï –ü–†–û–ò–°–•–û–î–ò–¢
```

### –ü—Ä–∏–º–µ—Ä 3: –û–±—ã—á–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥
```bash
# –ö–æ–º–∞–Ω–¥–∞
python parse_avito_to_db.py --metro-ids 1,2,3

# –†–µ–∑—É–ª—å—Ç–∞—Ç
üîÑ –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—ã –¥–ª—è –≤—Å–µ—Ö –º–µ—Ç—Ä–æ (–æ–±—ã—á–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥)
‚úÖ –°–±—Ä–æ—à–µ–Ω —Å—Ç–∞—Ç—É—Å –ø–∞–≥–∏–Ω–∞—Ü–∏–∏ –¥–ª—è –≤—Å–µ—Ö –º–µ—Ç—Ä–æ
```

## üîÑ **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è**

- ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–±—Ä–æ—Å**: –°—Ç—Ä–∞–Ω–∏—Ü—ã —Å–±—Ä–∞—Å—ã–≤–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –Ω–æ–≤–æ–º —Ü–∏–∫–ª–µ
- ‚úÖ **–†–∞–∑–ª–∏—á–µ–Ω–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤**: –°–∏—Å—Ç–µ–º–∞ –ø–æ–Ω–∏–º–∞–µ—Ç, –∫–æ–≥–¥–∞ –Ω—É–∂–µ–Ω —Å–±—Ä–æ—Å, –∞ –∫–æ–≥–¥–∞ –Ω–µ—Ç
- ‚úÖ **–ü–æ–ª–Ω–æ—Ç–∞ –¥–∞–Ω–Ω—ã—Ö**: –ü—Ä–∏ –Ω–æ–≤–æ–º —Ü–∏–∫–ª–µ –≤—Å–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –∑–∞–Ω–æ–≤–æ
- ‚úÖ **–ü—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ—Å—Ç—å**: –ü–æ–≤–µ–¥–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã–º
- ‚úÖ **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –ù–µ—Ç —Ä–∏—Å–∫–∞ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –Ω–æ–≤—ã–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è

## üìã **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏**

### –§—É–Ω–∫—Ü–∏—è `reset_avito_pagination()`:
- **–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ**: `parse_todb_avito.py`, —Å—Ç—Ä–æ–∫–∞ 402
- **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**: `metro_id: int = None` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- **–î–µ–π—Å—Ç–≤–∏–µ**: –°–±—Ä–∞—Å—ã–≤–∞–µ—Ç `last_processed_page = 0` –∏ `total_pages_processed = 0`
- **–í–æ–∑–≤—Ä–∞—Ç**: `bool` (—É—Å–ø–µ—Ö/–Ω–µ—É–¥–∞—á–∞)

### –õ–æ–≥–∏–∫–∞ –≤—ã–∑–æ–≤–∞:
```python
# –°–±—Ä–æ—Å –¥–ª—è –≤—Å–µ—Ö –º–µ—Ç—Ä–æ
await reset_avito_pagination()

# –°–±—Ä–æ—Å –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –º–µ—Ç—Ä–æ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
await reset_avito_pagination(metro_id=5)
```

## üéâ **–ò—Ç–æ–≥**

–õ–æ–≥–∏–∫–∞ —Å–±—Ä–æ—Å–∞ —Å—Ç—Ä–∞–Ω–∏—Ü —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∞:
- ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–±—Ä–æ—Å** –ø—Ä–∏ –Ω–æ–≤–æ–º —Ü–∏–∫–ª–µ —Ä–∞–±–æ—Ç—ã
- ‚úÖ **–£–º–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ** –∫–æ–≥–¥–∞ –Ω—É–∂–µ–Ω —Å–±—Ä–æ—Å
- ‚úÖ **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö** - –≤—Å–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –∑–∞–Ω–æ–≤–æ
- ‚úÖ **–ü—Ä–æ—Å—Ç–æ—Ç–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è** - —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

–¢–µ–ø–µ—Ä—å –ø—Ä–∏ –Ω–æ–≤–æ–º —Ü–∏–∫–ª–µ –ø–∞—Ä—Å–∏–Ω–≥–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–±—Ä–∞—Å—ã–≤–∞—é—Ç—Å—è, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è –ø–æ–ª–Ω–æ—Ç—É –¥–∞–Ω–Ω—ã—Ö! üéØ
