# üöá –ü–∞—Ä—Å–µ—Ä –º–µ—Ç—Ä–æ Avito - –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

## üìã –û–ø–∏—Å–∞–Ω–∏–µ

`parse_avito.py` - —ç—Ç–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –ø–∞—Ä—Å–µ—Ä –æ–±—ä—è–≤–ª–µ–Ω–∏–π Avito, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –∫–∞–∫ —Å –æ–¥–Ω–∏–º –º–µ—Ç—Ä–æ, —Ç–∞–∫ –∏ —Å–æ –≤—Å–µ–º–∏ –º–µ—Ç—Ä–æ –ú–æ—Å–∫–≤—ã –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ.

## üéØ –ù–æ–≤—ã–π –º–µ—Ç–æ–¥: `parse_metro_by_id()`

### –û–ø–∏—Å–∞–Ω–∏–µ
–ú–µ—Ç–æ–¥ –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ **–æ–¥–Ω–æ–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Å—Ç–∞–Ω—Ü–∏–∏ –º–µ—Ç—Ä–æ** —Å –∑–∞–¥–∞–Ω–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏.

### –°–∏–≥–Ω–∞—Ç—É—Ä–∞
```python
async def parse_metro_by_id(self, metro_id, max_pages=None, max_cards=None):
```

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã
- **`metro_id`** (int) - ID —Å—Ç–∞–Ω—Ü–∏–∏ –º–µ—Ç—Ä–æ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã `metro` (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π)
- **`max_pages`** (int, optional) - –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–∞–Ω–∏—Ü:
  - `None` - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞
  - `0` - –Ω–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–∞–Ω–∏—Ü
  - `> 0` - –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–∞–Ω–∏—Ü
- **`max_cards`** (int, optional) - –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–∞—Ä—Ç–æ—á–µ–∫ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É:
  - `None` - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞
  - `> 0` - –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–∞—Ä—Ç–æ—á–µ–∫

### –í–æ–∑–≤—Ä–∞—â–∞–µ–º–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
```python
{
    'success': bool,           # –£—Å–ø–µ—à–Ω–æ—Å—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–∏
    'metro_name': str,         # –ù–∞–∑–≤–∞–Ω–∏–µ —Å—Ç–∞–Ω—Ü–∏–∏ –º–µ—Ç—Ä–æ
    'total_cards': int,        # –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –∫–∞—Ä—Ç–æ—á–µ–∫
    'saved_cards': int,        # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –≤ –ë–î –∫–∞—Ä—Ç–æ—á–µ–∫
    'error': str or None       # –û–ø–∏—Å–∞–Ω–∏–µ –æ—à–∏–±–∫–∏ (–µ—Å–ª–∏ –µ—Å—Ç—å)
}
```

## üöÄ –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### 1. –ü—Ä–æ—Å—Ç–æ–π –ø–∞—Ä—Å–∏–Ω–≥ –æ–¥–Ω–æ–≥–æ –º–µ—Ç—Ä–æ

```python
import asyncio
from parse_avito import AvitoMetroParser

async def simple_example():
    # –°–æ–∑–¥–∞–µ–º –ø–∞—Ä—Å–µ—Ä
    parser = AvitoMetroParser(
        enable_db=True,      # –í–∫–ª—é—á–∞–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î
        headless=True        # –ó–∞–ø—É—Å–∫–∞–µ–º –≤ headless —Ä–µ–∂–∏–º–µ
    )
    
    try:
        # –ü–∞—Ä—Å–∏–º –º–µ—Ç—Ä–æ ID = 1, –º–∞–∫—Å–∏–º—É–º 2 —Å—Ç—Ä–∞–Ω–∏—Ü—ã, 5 –∫–∞—Ä—Ç–æ—á–µ–∫ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É
        result = await parser.parse_metro_by_id(
            metro_id=1,
            max_pages=2,
            max_cards=5
        )
        
        if result['success']:
            print(f"‚úÖ –£—Å–ø–µ—à–Ω–æ! –°–æ—Ö—Ä–∞–Ω–µ–Ω–æ {result['saved_cards']} –∫–∞—Ä—Ç–æ—á–µ–∫")
        else:
            print(f"‚ùå –û—à–∏–±–∫–∞: {result['error']}")
            
    finally:
        # –ó–∞–∫—Ä—ã–≤–∞–µ–º –±—Ä–∞—É–∑–µ—Ä
        if hasattr(parser, 'driver') and parser.driver:
            parser.driver.quit()

# –ó–∞–ø—É—Å–∫
asyncio.run(simple_example())
```

### 2. –ü–∞—Ä—Å–∏–Ω–≥ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –º–µ—Ç—Ä–æ

```python
async def multiple_metros_example():
    parser = AvitoMetroParser(enable_db=True, headless=True)
    
    # –°–ø–∏—Å–æ–∫ –º–µ—Ç—Ä–æ –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞
    metros = [
        {'id': 1, 'max_pages': 2, 'max_cards': 3},    # –ß–∫–∞–ª–æ–≤—Å–∫–∞—è
        {'id': 2, 'max_pages': 1, 'max_cards': 5},    # –ú–∞—è–∫–æ–≤—Å–∫–∞—è
        {'id': 3, 'max_pages': 3, 'max_cards': 4},    # –¢—Ä–µ—Ç—å—è–∫–æ–≤—Å–∫–∞—è
    ]
    
    total_saved = 0
    
    try:
        for metro_config in metros:
            result = await parser.parse_metro_by_id(
                metro_id=metro_config['id'],
                max_pages=metro_config['max_pages'],
                max_cards=metro_config['max_cards']
            )
            
            if result['success']:
                print(f"‚úÖ {result['metro_name']}: {result['saved_cards']} –∫–∞—Ä—Ç–æ—á–µ–∫")
                total_saved += result['saved_cards']
            else:
                print(f"‚ùå {metro_config['id']}: {result['error']}")
        
        print(f"üéâ –ò–¢–û–ì–û: {total_saved} –∫–∞—Ä—Ç–æ—á–µ–∫")
        
    finally:
        if hasattr(parser, 'driver') and parser.driver:
            parser.driver.quit()
```

### 3. –ù–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥

```python
async def unlimited_example():
    parser = AvitoMetroParser(enable_db=True, headless=True)
    
    try:
        # –ü–∞—Ä—Å–∏–º –≤—Å–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã (max_pages=0)
        result = await parser.parse_metro_by_id(
            metro_id=1,
            max_pages=0,      # –ù–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ —Å—Ç—Ä–∞–Ω–∏—Ü
            max_cards=10      # 10 –∫–∞—Ä—Ç–æ—á–µ–∫ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É
        )
        
        print(f"–ù–∞–π–¥–µ–Ω–æ: {result['total_cards']}, –°–æ—Ö—Ä–∞–Ω–µ–Ω–æ: {result['saved_cards']}")
        
    finally:
        if hasattr(parser, 'driver') and parser.driver:
            parser.driver.quit()
```

## üîß –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–∞–±–æ—Ç—ã

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
- –ï—Å–ª–∏ –±—Ä–∞—É–∑–µ—Ä –Ω–µ –∑–∞–ø—É—â–µ–Ω, –º–µ—Ç–æ–¥ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
  - –ó–∞–≥—Ä—É–∂–∞–µ—Ç —Å–ø–∏—Å–æ–∫ —Å—Ç–∞–Ω—Ü–∏–π –º–µ—Ç—Ä–æ
  - –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç Selenium WebDriver
  - –ó–∞–≥—Ä—É–∂–∞–µ—Ç –∏ –ø—Ä–∏–º–µ–Ω—è–µ—Ç cookies

### –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫
- –ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –º–µ—Ç–æ–¥–∞ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ `max_pages` –∏ `max_cards`
- –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–¥–∏–Ω —ç–∫–∑–µ–º–ø–ª—è—Ä –ø–∞—Ä—Å–µ—Ä–∞ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –∑–∞–¥–∞—á

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- –ú–µ—Ç–æ–¥ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ–± –æ—à–∏–±–∫–∞—Ö
- –ë—Ä–∞—É–∑–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö

## üìä –°–æ—Ö—Ä–∞–Ω—è–µ–º—ã–µ –ø–æ–ª—è

–ú–µ—Ç–æ–¥ –∏–∑–≤–ª–µ–∫–∞–µ—Ç –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç **–≤—Å–µ –ø–æ–ª—è** –∏–∑ –æ–±—ä—è–≤–ª–µ–Ω–∏–π:

- ‚úÖ `title` - –∑–∞–≥–æ–ª–æ–≤–æ–∫
- ‚úÖ `price` - —Ü–µ–Ω–∞
- ‚úÖ `rooms` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–º–Ω–∞—Ç (–∏–∑ –∑–∞–≥–æ–ª–æ–≤–∫–∞)
- ‚úÖ `area` - –ø–ª–æ—â–∞–¥—å –≤ –º¬≤ (–∏–∑ –∑–∞–≥–æ–ª–æ–≤–∫–∞)
- ‚úÖ `floor` - —ç—Ç–∞–∂ (–∏–∑ –∑–∞–≥–æ–ª–æ–≤–∫–∞)
- ‚úÖ `total_floors` - –≤—Å–µ–≥–æ —ç—Ç–∞–∂–µ–π (–∏–∑ –∑–∞–≥–æ–ª–æ–≤–∫–∞)
- ‚úÖ `metro` - –Ω–∞–∑–≤–∞–Ω–∏–µ –º–µ—Ç—Ä–æ
- ‚úÖ `min_metro` - –≤—Ä–µ–º—è –¥–æ –º–µ—Ç—Ä–æ (–∏–∑ –∞–¥—Ä–µ—Å–∞)
- ‚úÖ `address` - –∞–¥—Ä–µ—Å (—É–ª–∏—Ü–∞, –¥–æ–º)
- ‚úÖ `person` - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–æ–¥–∞–≤—Ü–µ
- ‚úÖ `person_type` - —Ç–∏–ø –ø—Ä–æ–¥–∞–≤—Ü–∞
- ‚úÖ `tags` - —Ç–µ–≥–∏ –∫–∞—Ä—Ç–æ—á–∫–∏
- ‚úÖ `source_created` - –¥–∞—Ç–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏

## üéØ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

1. **–ì–∏–±–∫–æ—Å—Ç—å** - –º–æ–∂–Ω–æ –∑–∞–¥–∞–≤–∞—Ç—å –ª—é–±—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –º–µ—Ç—Ä–æ
2. **–ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ** - –æ–¥–∏–Ω —ç–∫–∑–µ–º–ø–ª—è—Ä –ø–∞—Ä—Å–µ—Ä–∞ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –∑–∞–¥–∞—á
3. **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è** - –Ω–µ –Ω—É–∂–Ω–æ –≤—Ä—É—á–Ω—É—é —É–ø—Ä–∞–≤–ª—è—Ç—å –±—Ä–∞—É–∑–µ—Ä–æ–º
4. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** - –¥–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö
5. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –ú–µ—Ç–æ–¥ **–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π** - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `await` –ø—Ä–∏ –≤—ã–∑–æ–≤–µ
- –í—Å–µ–≥–¥–∞ **–∑–∞–∫—Ä—ã–≤–∞–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä** –≤ –±–ª–æ–∫–µ `finally`
- –î–ª—è **–º–∞—Å—Å–æ–≤–æ–≥–æ –ø–∞—Ä—Å–∏–Ω–≥–∞** –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `parse_all_metro_stations()`
- **Cookies** –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑ `avito_cookies.json`
