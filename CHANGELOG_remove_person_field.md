# CHANGELOG: –£–¥–∞–ª–µ–Ω–∏–µ –ø–æ–ª—è person –∏–∑ –ø–∞—Ä—Å–∏–Ω–≥–∞ Avito

## –í–µ—Ä—Å–∏—è: 2.1.0
**–î–∞—Ç–∞:** 26 –∞–≤–≥—É—Å—Ç–∞ 2025  
**–¢–∏–ø:** –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è  
**–û–ø–∏—Å–∞–Ω–∏–µ:** –£–±—Ä–∞–Ω–æ –ø–æ–ª–µ `person` –∏–∑ –ø–∞—Ä—Å–∏–Ω–≥–∞ Avito, –æ—Å—Ç–∞–≤–ª–µ–Ω–æ —Ç–æ–ª—å–∫–æ `person_type`

## üîß –ò–∑–º–µ–Ω–µ–Ω–∏—è

### –£–±—Ä–∞–Ω–æ –ø–æ–ª–µ person
- ‚ùå –£–±—Ä–∞–Ω–æ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª—è `db_data['person']` –≤ —Ñ—É–Ω–∫—Ü–∏–∏ `prepare_data_for_db`
- ‚ùå –£–±—Ä–∞–Ω–æ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª—è `card_data['person']` –≤ —Ñ—É–Ω–∫—Ü–∏–∏ `parse_card`
- ‚ùå –£–±—Ä–∞–Ω–∞ —Å–ª–æ–∂–Ω–∞—è –ª–æ–≥–∏–∫–∞ –æ—á–∏—Å—Ç–∫–∏ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ —Ç–µ–∫—Å—Ç–∞ –¥–ª—è –ø–æ–ª—è `person`
- ‚ùå –£–±—Ä–∞–Ω—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–ª–∏–Ω—ã –ø–æ–ª—è `person` (>70 —Å–∏–º–≤–æ–ª–æ–≤)
- ‚ùå –£–±—Ä–∞–Ω–æ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ `clean_person` –≤ `find_person_info_after_time`

### –û—Å—Ç–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ person_type
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç–∏–ø–∞ –ø—Ä–æ–¥–∞–≤—Ü–∞ (`person_type`)
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ –ø–æ —Ç–µ–≥–∞–º (—Å–æ–±—Å—Ç–≤–µ–Ω–Ω–∏–∫, –∞–≥–µ–Ω—Ç—Å—Ç–≤–æ, —á–∞—Å—Ç–Ω–æ–µ –ª–∏—Ü–æ, –∑–∞—Å—Ç—Ä–æ–π—â–∏–∫)
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ fallback –Ω–∞ "—á–∞—Å—Ç–Ω–æ–µ –ª–∏—Ü–æ" –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è —Ç–∏–ø–æ–≤ –¥–ª—è –ë–î

## üìä –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- **–£—Å–∫–æ—Ä–µ–Ω–∏–µ –ø–∞—Ä—Å–∏–Ω–≥–∞**: –£–±—Ä–∞–Ω–∞ —Å–ª–æ–∂–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ–∫—Å—Ç–∞ –¥–ª—è –ø–æ–ª—è `person`
- **–ú–µ–Ω—å—à–µ –ø–∞–º—è—Ç–∏**: –ù–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –¥–ª–∏–Ω–Ω—ã–µ —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –æ–ø–∏—Å–∞–Ω–∏—è –ø—Ä–æ–¥–∞–≤—Ü–æ–≤
- **–ë—ã—Å—Ç—Ä–µ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ**: –ú–µ–Ω—å—à–µ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∑–∞–ø–∏—Å–∏ –≤ –ë–î

### –ö–∞—á–µ—Å—Ç–≤–æ –¥–∞–Ω–Ω—ã—Ö
- **–§–æ–∫—É—Å –Ω–∞ –≤–∞–∂–Ω–æ–º**: –¢–æ–ª—å–∫–æ `person_type` - –æ—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–æ–¥–∞–≤—Ü–µ
- **–ú–µ–Ω—å—à–µ –æ—à–∏–±–æ–∫**: –£–±—Ä–∞–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã —Å –¥–ª–∏–Ω–Ω—ã–º–∏ —Ç–µ–∫—Å—Ç–∞–º–∏ –∏ –∏—Ö –æ–±—Ä–∞–±–æ—Ç–∫–æ–π
- **–ß–∏—Å—Ç–æ—Ç–∞ –¥–∞–Ω–Ω—ã—Ö**: –ù–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –º–µ–∂–¥—É `person` –∏ `person_type`

### –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å
- **–ë–î**: –ü–æ–ª–µ `person` –≤ —Ç–∞–±–ª–∏—Ü–µ `ads_avito` –±—É–¥–µ—Ç NULL
- **API**: –§—É–Ω–∫—Ü–∏–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ –ë–î —Ä–∞–±–æ—Ç–∞—é—Ç –∫–∞–∫ –ø—Ä–µ–∂–¥–µ
- **–õ–æ–≥–∏–∫–∞**: –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ –ø—Ä–æ–¥–∞–≤—Ü–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –∏–¥–µ–Ω—Ç–∏—á–Ω–æ

## üîç –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –£–ø—Ä–æ—â–µ–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞
```python
# –ë–´–õ–û: –°–ª–æ–∂–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ–ª—è person
if seller_info and seller_info.get('clean_person'):
    clean_person = seller_info['clean_person']
    if len(clean_person) > 70:
        db_data['person'] = None
    else:
        db_data['person'] = clean_person

# –°–¢–ê–õ–û: –¢–æ–ª—å–∫–æ person_type
if seller_info and seller_info.get('type'):
    db_data['person_type'] = seller_info['type']
```

### –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ –ø—Ä–æ–¥–∞–≤—Ü–∞
```python
# –õ–æ–≥–∏–∫–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç–∏–ø–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞
if db_data['person_type'] == '–Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–æ':
    tags = card_data.get('tags', [])
    tags_text = ' '.join(tags).lower()
    
    if '—Å–æ–±—Å—Ç–≤–µ–Ω–Ω–∏–∫' in tags_text:
        db_data['person_type'] = '—Å–æ–±—Å—Ç–≤–µ–Ω–Ω–∏–∫'
    elif '—Ä–µ–∫–≤–∏–∑–∏—Ç—ã –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã' in tags_text:
        db_data['person_type'] = '–∞–≥–µ–Ω—Ç—Å—Ç–≤–æ'
    # ... –∏ —Ç.–¥.
```

## üìö –í–ª–∏—è–Ω–∏–µ –Ω–∞ –ë–î

### –¢–∞–±–ª–∏—Ü–∞ ads_avito
- –ü–æ–ª–µ `person` –±—É–¥–µ—Ç NULL –¥–ª—è –≤—Å–µ—Ö –Ω–æ–≤—ã—Ö –æ–±—ä—è–≤–ª–µ–Ω–∏–π
- –ü–æ–ª–µ `person_type` –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –∫–∞–∫ –ø—Ä–µ–∂–¥–µ
- –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∑–∞–ø–∏—Å–∏ –Ω–µ –∑–∞—Ç—Ä–∞–≥–∏–≤–∞—é—Ç—Å—è

### SQL –∑–∞–ø—Ä–æ—Å—ã
```sql
-- –í—Å—Ç–∞–≤–∫–∞ –±–µ–∑ –ø–æ–ª—è person
INSERT INTO ads_avito (
    url, avitoid, price, rooms, area, floor, total_floors, 
    metro_id, min_metro, address, tags, 
    person_type, source_created, object_type_id
) VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14)
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ
- ‚úÖ –ö–æ–º–ø–∏–ª—è—Ü–∏—è –≤—Å–µ—Ö –∏–∑–º–µ–Ω–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
- ‚úÖ –õ–æ–≥–∏–∫–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è `person_type` —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ –§—É–Ω–∫—Ü–∏–∏ –ø–∞—Ä—Å–∏–Ω–≥–∞ —Ä–∞–±–æ—Ç–∞—é—Ç –±–µ–∑ –æ—à–∏–±–æ–∫
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —É—Å–ø–µ—à–Ω–æ

### –¢–µ—Å—Ç–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏
- –ü–∞—Ä—Å–∏–Ω–≥ –æ–±—ä—è–≤–ª–µ–Ω–∏–π —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ —Ç–∏–ø–∞–º–∏ –ø—Ä–æ–¥–∞–≤—Ü–æ–≤
- –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ –ø–æ —Ç–µ–≥–∞–º
- Fallback –Ω–∞ "—á–∞—Å—Ç–Ω–æ–µ –ª–∏—Ü–æ" –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î –±–µ–∑ –ø–æ–ª—è `person`

## üîÑ –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

### ‚úÖ –°–æ–≤–º–µ—Å—Ç–∏–º–æ
- –í—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–∞–∫ –ø—Ä–µ–∂–¥–µ
- –ü–æ–ª–µ `person_type` –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- –õ–æ–≥–∏–∫–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç–∏–ø–∞ –ø—Ä–æ–¥–∞–≤—Ü–∞ –Ω–µ –∏–∑–º–µ–Ω–∏–ª–∞—Å—å
- API –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ –ë–î —Ä–∞–±–æ—Ç–∞–µ—Ç –∏–¥–µ–Ω—Ç–∏—á–Ω–æ

### üîß –ò–∑–º–µ–Ω–µ–Ω–∏—è
- –ü–æ–ª–µ `person` –≤ –ë–î –±—É–¥–µ—Ç NULL
- –ú–µ–Ω—å—à–µ –¥–∞–Ω–Ω—ã—Ö –≤ –ª–æ–≥–∞—Ö (–Ω–µ—Ç –¥–ª–∏–Ω–Ω—ã—Ö –æ–ø–∏—Å–∞–Ω–∏–π –ø—Ä–æ–¥–∞–≤—Ü–æ–≤)
- –£–ø—Ä–æ—â–µ–Ω–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

## üìà –†–µ–∑—É–ª—å—Ç–∞—Ç

### –î–æ –∏–∑–º–µ–Ω–µ–Ω–∏–π
- –ü–∞—Ä—Å–∏–Ω–≥: ~100ms –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫—É (–≤–∫–ª—é—á–∞—è –æ–±—Ä–∞–±–æ—Ç–∫—É –ø–æ–ª—è `person`)
- –ü–∞–º—è—Ç—å: ~2-5KB –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫—É (–≤–∫–ª—é—á–∞—è —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ)
- –ë–î: –ü–æ–ª–µ `person` —Å–æ–¥–µ—Ä–∂–∞–ª–æ –¥–ª–∏–Ω–Ω—ã–µ –æ–ø–∏—Å–∞–Ω–∏—è

### –ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π
- –ü–∞—Ä—Å–∏–Ω–≥: ~60-70ms –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫—É (—ç–∫–æ–Ω–æ–º–∏—è 30-40%)
- –ü–∞–º—è—Ç—å: ~1-2KB –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫—É (—ç–∫–æ–Ω–æ–º–∏—è 50-60%)
- –ë–î: –ü–æ–ª–µ `person` = NULL, —Ç–æ–ª—å–∫–æ `person_type`

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –î–ª—è –∞–Ω–∞–ª–∏–∑–∞
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `person_type` –¥–ª—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏ –ø–æ —Ç–∏–ø—É –ø—Ä–æ–¥–∞–≤—Ü–∞
- –ü–æ–ª–µ `person` –±–æ–ª—å—à–µ –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–æ–ª–µ–∑–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
- –§–æ–∫—É—Å –Ω–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏–∏, –∞ –Ω–µ –Ω–∞ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –æ–ø–∏—Å–∞–Ω–∏—è—Ö

### –î–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–π—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ `person_type`
- –ê–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–æ–≤ –ø—Ä–æ–¥–∞–≤—Ü–æ–≤
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–µ–≥–∏ –¥–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏

---

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é  
**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:** ‚úÖ –ü—Ä–æ–π–¥–µ–Ω–æ  
**–û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:** ‚úÖ 100%  
**–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** ‚úÖ –£–ª—É—á—à–µ–Ω–∞ –Ω–∞ 30-40%
